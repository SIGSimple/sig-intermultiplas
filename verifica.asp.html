<html>
<head>
<title>Untitled Document</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>

<body bgcolor="#FFFFFF" text="#000000">
<%
inicio = Timer
%>
<table width="65%" border="0" cellspacing="0" cellpadding="0" align="center">
  <tr>
    <td>
      <p align="center"><font face="Verdana, Arial, Helvetica, sans-serif" 6="6" size="1" color="#000080">Informa&ccedil;&otilde;es 
        do Servidor</font><font face="Verdana, Arial, Helvetica, sans-serif" size="1"><br>
        Disponível Somente para Servidores Web Windows</font> 
      <table border="0" cellpadding="0" cellspacing="0" width="818">
        <tr> 
          <td valign="TOP" width="454" bgcolor="#FFCC99"><font face="Verdana, Arial, Helvetica, sans-serif" size="1"><small>Nome 
            do Servidor: <font color="#0000FF"> 
            <% = Request.ServerVariables("SERVER_NAME") %>
            </font><br>
            Nome do Script: <font color="#0000FF"> 
            <% = Request.ServerVariables("SCRIPT_NAME") %>
            </font><br>
            Protocolo do Servidor: <font color="#0000FF"> 
            <% = Request.ServerVariables("SERVER_PROTOCOL") %>
            </font><br>
            Pasta Local: <font color="#0000FF"> 
            <% = Request.ServerVariables("PATH_INFO") %>
            </font><br>
            Endereço do Físico: <font color="#0000FF"> 
            <% = Request.ServerVariables("PATH_TRANSLATED") %>
            </font><br>
            Referencia HTTP:// : <font color="#0000FF"> 
            <% = Request.ServerVariables("HTTP_REFERER") %>
            </font> </small> </font><font color="#0000FF" face="Verdana, Arial, Helvetica, sans-serif" size="1"><a href="http://<% = Request.ServerVariables("SERVER_NAME") %>" target="_blank"> 
            <% = Request.ServerVariables("SERVER_NAME") %>
            </a> </font></td>
          <td valign="TOP" width="364" bgcolor="#FFCC99"> <font size="1" 4="4" face="Verdana, Arial, Helvetica, sans-serif">Informações 
            do Sistema</font> <font size="1" face="Verdana, Arial, Helvetica, sans-serif"><br>
            <small>Sistema</small>: <font color="#0000FF"> 
            <% = ScriptEngine %>
            </font><br>
            Versão: <font color="#0000FF"> 
            <%  =ScriptEngineMajorVersion() %>
            </font>.<font color="#0000FF"> 
            <% =ScriptEngineMinorVersion() %>
            </font><br>
            <small>Atualizado: </small> <small><font color="#0000FF"> 
            <% =ScriptEngineBuildVersion() %>
            </font><br>
            </small> </font> </td>
        </tr>
      </table>
      <div align="center"></div>
      <table width="53%" border="0" cellspacing="0" cellpadding="0" height="43">
        <tr> 
          <td> 
            <div align="left"><font face="Verdana, Arial, Helvetica, sans-serif" size="1">CDONTS 
              Object:&nbsp;</font><font size="1" face="Verdana, Arial, Helvetica, sans-serif"> 
              <font color="#800000"> 
              <% Err.Clear
   On Error Resume Next
   Set objCDONTS = Server.CreateObject("CDONTS.Session")
   If Err.Number <> 0 Then
      Response.Write("<B>NÃO INSTALADO</B>&nbsp;&nbsp;")
   Else
      Response.Write("<B>Versão: </B>" & objCDONTS.Version & " INSTALADO&nbsp;&nbsp;")
   End If
%>
              </font> <br>
              ADO DB Object:&nbsp;<font color="#800000"> 
              <% Err.Clear
   On Error Resume Next
   Set objConn = Server.CreateObject("ADODB.Connection")
   If Err.Number <> 0 Then
      Response.Write("ADODB.Connection object <B>NÃO INSTALADO</B>")
   Else
      Response.Write("<B>Versão: </B>" & objConn.Version & "<BR>")
   End If
%>
              </font> <br>
              File System Object<font color="#800000"> 
              <% Err.Clear
   On Error Resume Next
   Set objFSO = Server.CreateObject("Scripting.FileSystemObject")
   If Err.Number <> 0 Then
      Response.Write("NÃO INSTALADO")
   Else
      Response.Write("INSTALADO")
   End If
%>
              </font> <br>
              ASPMail Object<font color="#800000"> 
              <% Err.Clear
   On Error Resume Next
   Set objASPMail = Server.CreateObject("SMTPsvg.Mailer")
   If Err.Number <> 0 Then
      Response.Write("INSTALADA")
   Else
      Response.Write("VERSÃO INSTALADO " & objASPMail.Version )
      Response.Write("<BR><SMALL>EXPIRA EM:" & objASPMail.Expires & "</SMALL>" )
   End If
   Response.Write("<BR><FONT SIZE=""2"">Para Mais Informações <A HREF=""http://www.serverobjects.com"" TARGET=""RESOURCE WINDOW"">www.serverobjects.com</A></FONT>&nbsp;&nbsp;")
%>
              </font> &nbsp;<br>
              ASPImage Object<font color="#800000"> 
              <% Err.Clear
   On Error Resume Next
   Set objASPImage = Server.CreateObject("AspImage.Image")
   If Err.Number <> 0 Then
      Response.Write("NÃO INSTALADO")
   Else
      Response.Write("VERSÃO INSTALADA " & objASPImage.Version )
      Response.Write("<BR><SMALL>EXPIRA EM:" & objASPImage.Expires & "</SMALL>")      
   End If
   Response.Write("<BR><FONT SIZE=""2"">Para Mais Informações <A HREF=""http://www.serverobjects.com"" TARGET=""RESOURCE WINDOW"">www.serverobjects.com</A></FONT>")
%>
              </font> <br>
              ASPUpload Object<font color="#800000"> 
              <% Err.Clear
   On Error Resume Next
   Set objASPUpload = Server.CreateObject("Persits.Upload.1")
   If Err.Number <> 0 Then
      Response.Write("NÃO INSTALADO")
   Else
      Response.Write("INSTALADO ")
   End If
   Response.Write("<BR><FONT SIZE=""2"">Para Mais Informações <A HREF=""http://www.persits.com"" TARGET=""RESOURCE WINDOW"">www.persits.com</A></FONT>")
%>
              </font> <br>
              ASPEmail Object<font color="#800000"> 
              <% Err.Clear
   On Error Resume Next
   Set objASPEmail = Server.CreateObject("Persits.MailSender")
   If Err.Number <> 0 Then
      Response.Write("NÃO INSTALADO")
   Else
      Response.Write("INSTALADO ")
      Response.Write("<BR><SMALL>Expires On:" & objASPEmail.Expires & "</SMALL>")      
   End If
   Response.Write("<BR><FONT SIZE=""2"">Para Mais Informações <A HREF=""http://www.persits.com"" TARGET=""RESOURCE WINDOW"">www.persits.com</A></FONT>&nbsp;&nbsp;")
%>
              </font> &nbsp;<br>
              JMail Object<font color="#800000"> 
              <% Err.Clear
   On Error Resume Next
   Set objJMail = Server.CreateObject("JMail.SMTPMail")
   If Err.Number <> 0 Then
      Response.Write("NÃO INSTALADO")
   Else
      Response.Write("INSTALADO ")
   End If
   Response.Write("<BR><FONT SIZE=""2"">Para Mais Informações <A HREF=""http://www.dimac.net"" TARGET=""RESOURCE WINDOW"">www.dimac.net</A></FONT>&nbsp;&nbsp;")
%>
              </font> &nbsp;<br>
              Bamboo.SMTP Object<font color="#800000"> 
              <% Err.Clear
   On Error Resume Next
   Set objBamboo = Server.CreateObject("Bamboo.SMTP")
   If Err.Number <> 0 Then
      Response.Write("NÃO INSTALADO")
   Else
      Response.Write("INSTALADO ")
   End If
   Response.Write("&nbsp;&nbsp;")
%>
              </font> <br>
              Informações desta Transmissão<font color="#000080"> 
              <%
   On Error Resume Next
   vRunDate = Now
   sRunDate = Request.QueryString("DATE")
   If Len(Trim(sRunDate)) = 0 Then
      sRunDate = Request.Form("DATE")
   End If
   Response.Write("<FONT SIZE=""2"">")
   If IsDate(sRunDate) Then
      vRunDate = CDate(sRunDate)
      Response.Write("<BR><FONT SIZE=""2"">RunDate:" & sRunDate)
   Else
      Response.Write("<BR>RunDate: Now")
   End If
   Response.Write("<BR>RunDate : " & vRunDate )
   Response.Write("<BR>CDate(RunDate) : " & CDate(vRunDate) )
   Response.Write("<BR>CDate("" & RunDate) : " & CDate("" & vRunDate) )
%>
              </font> 
              <%
Application.Lock
IF NOT isArray( Application( "lastTen" ) ) THEN
DIM dummy( 10, 3 )
Application( "lastTen" ) = dummy
END IF
lastTen = Application( "lastTen" )
Application.UnLock

' Mover cada visita abaixo no Array
IF lastTen( 9, 0 ) <> "" THEN
FOR i = 0 TO 9
lastTen( i, 0 ) = lastTen( i + 1, 0 )
lastTen( i, 1 ) = lastTen( i + 1, 1 )
lastTen( i, 2 ) = lastTen( i + 1, 2 )
NEXT
END IF

' Somar uma nova entrada
FOR i = 0 TO 9
IF lastTen( i, 0 ) = "" THEN
lastTen( i, 0 ) = Request.ServerVariables( "REMOTE_ADDR" )
lastTen( i, 1 ) = Request.ServerVariables( "HTTP_USER_AGENT" )
lastTen( i, 2 ) = NOW()
EXIT FOR
END IF
NEXT

Application.Lock
Application( "lastTen" ) = lastTen
Application.UnLock 

%>
              <br>
              </font> <font face="Verdana, Arial, Helvetica, sans-serif" size="1"><em><font 2>Transmitido: 
              <font color="#FF0000"> 
              <% = Now %>
              </font></font></em></font></div>
          </td>
        </tr>
      </table>
      <font face="Verdana, Arial, Helvetica, sans-serif" size="1"> </font> 
      <p><font face="Verdana, Arial, Helvetica, sans-serif" size="1"><font 2>Mostrar 
        os 10 Últimos Acessos a este Script:</font> <br>
        Seu IP :<small> </small><font color="#0000FF"><%= request.servervariables("REMOTE_ADDR") %> 
        </font> </font><font face="Verdana, Arial, Helvetica, sans-serif" size="1"><small></small></font><font face="Verdana, Arial, Helvetica, sans-serif" size="1"> 
        </font></p>
      <font face="Arial"> 
      <div align="left"> 
        <table bgcolor="#FFCC66" cellspacing=0 cellpadding=3 border=0>
          <tr bgcolor="lightyellow"> 
            <td><b><font 2="2" size="1" color="#000080" face="Verdana, Arial, Helvetica, sans-serif">Visitas</font></b></td>
            <td><b><font 2="2" size="1" color="#000080" face="Verdana, Arial, Helvetica, sans-serif">Direção 
              IP</font></b></td>
            <td><b><font 2="2" size="1" color="#000080" face="Verdana, Arial, Helvetica, sans-serif">Browser</font></b></td>
            <td><b><font 2="2" size="1" color="#000080" face="Verdana, Arial, Helvetica, sans-serif">Hora 
              de Visita</font></b></td>
          </tr>
          <font size="1" 2="2" face="Verdana, Arial, Helvetica, sans-serif"> <b> 
          <% 
FOR i = 0 TO 9 
IF lastTen( i, 0 ) <> "" THEN
%>
          </b></font> 
          <tr> 
            <td><b><font 2="2" size="1" face="Verdana, Arial, Helvetica, sans-serif"><%=i + 1%></font></b></td>
            <td><b><font 2="2" size="1" face="Verdana, Arial, Helvetica, sans-serif"><%=lastTen( i, 0 )%></font></b></td>
            <td><b><font 2="2" size="1" face="Verdana, Arial, Helvetica, sans-serif"><%=lastTen( i, 1 )%></font></b></td>
            <td><b><font 2="2" size="1" face="Verdana, Arial, Helvetica, sans-serif"><%=lastTen( i, 2 )%></font></b></td>
          </tr>
          <%
END IF
NEXT
%>
        </table>
        <font size="1" face="Verdana, Arial, Helvetica, sans-serif"><small>Tempo 
        de Respota do Servidor Web:<br>
        </small><font color="#0000FF"><small> 
<%
'... uma seqüência de comandos para medir a velocidade
response.write "Processado em " & FormatNumber( Timer - inicio, 2 ) & " segundos"
%>
        </small></font></font></div>
      </font></td>
  </tr>
</table>
</body>
</html>
